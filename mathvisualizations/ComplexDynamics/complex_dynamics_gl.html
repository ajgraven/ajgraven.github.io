<!--python -m http.server http://localhost:8000/!-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Complex Dynamics</title>
        <script type="text/javascript" src="../../assets/js/Cindy.js"></script>
        <script type="text/javascript" src="../../assets/js/CindyGL.js"></script>
        <link rel="stylesheet" href="../../assets/css/CindyJS.css" />
    </head>

    <body style="font-family: Arial" onload="loadFunction()">
        <h1>Complex Dynamics Visualization Tool (alpha version)</h1>
        <script id="csinit" type="text/x-cindyscript">
            import("csinit.cjs");
            colorFcn(u) := (
                if(u==n,(0,0,0),
                    u = u/n;
                    u = (3*u/(2*u+1));
                    (4*u,1.3*u,(1-u)^2*.7);
                );
            );

        </script>
        
        <script id="mcsmove" type="text/x-cindyscript">
            c = mCanvToPltZ(complex(C));
            javascript("document.getElementById('inpc').value = '" + c + "';");
            javascript("updatec([" + re(c) + "," + im(c) + "]);");
            colorplot([mandelminx,mandelminy],[mandelmaxx,mandelminy],"mandel", colorFcn(mandeliter(complex(#),complex(#))));
            drawimage([mandelcanvminx,mandelcanvminy],[mandelcanvmaxx,mandelcanvminy], "mandel");

            connect(apply(mandelniter(c,4),reim(mPltToCanvZ(#))),color->[1,1,1],size->1.8);

            drawtext(C+(.015,.015), "c="+c, color->[1,1,1],size->15);
        </script>

        <script id="jcsmove" type="text/x-cindyscript">
            colorplot([jminx,jminy],[jmaxx,jminy],"julia",colorFcn(juliaiter(complex(#), c)));
            drawimage([jcanvminx,jcanvminy],[jcanvmaxx,jcanvminy], "julia");

            connect(apply(julianiter(jCanvToPltZ(complex(I.xy)),c,8),reim(jPltToCanvZ(#))),color->[1,1,1],size->1.8);

            drawtext(I+(.015,.015), "z="+jCanvToPltZ(complex(I.xy)), color->[1,1,1],size->15);
        </script>

        <script id="jcskeydown" type="text/x-cindyscript">
            shiftRatio = 1/16;
            zoomRatio = 3/2;
            keyPressed = key();
            if(keyPressed=="»",jZoom(1/zoomRatio)); // zoom in
            if(keyPressed=="½",jZoom(zoomRatio)); // zoom out
            if(keyPressed=="&",jShift(shiftRatio,"vertical")); // translate up
            if(keyPressed=="(",jShift(-shiftRatio,"vertical")); // translate down
            if(keyPressed=="'",jShift(shiftRatio,"horizontal")); // translate right
            if(keyPressed=="%",jShift(-shiftRatio,"horizontal")); // translate left
        </script>

        <script id="mcskeydown" type="text/x-cindyscript">
            shiftRatio = 1/16;
            zoomRatio = 3/2;
            keyPressed = key();
            if(keyPressed=="»",mZoom(1/zoomRatio)); // zoom in
            if(keyPressed=="½",mZoom(zoomRatio)); // zoom out
            if(keyPressed=="&",mShift(shiftRatio,"vertical")); // translate up
            if(keyPressed=="(",mShift(-shiftRatio,"vertical")); // translate down
            if(keyPressed=="'",mShift(shiftRatio,"horizontal")); // translate right
            if(keyPressed=="%",mShift(-shiftRatio,"horizontal")); // translate left
        </script>

        <script id="mcsmousedown" type="text/x-cindyscript">
            print(mouse());
        </script>

        <script src="source.js" type="text/javascript"></script>

        <script type="text/javascript">
            function loadFunction() {
                document.getElementById('inpc').value = '-0.7 - i*0.4';
                apply_changes();
            }
        </script>


     <table cols=3 rows=2>
        <tr style="vertical-align: center;">
            <th>
                <div style="text-align:center;position:relative;display:inline-block;">
                    <h2>Parameter Space</h2>
                    <canvas id="MCSCanvas"></canvas>
                </div>
            </th>
            <th>
                <div style="text-align:center;position:relative;display:inline-block;">
                    <h2>Dynamical Plane</h2>
                    <canvas id="JCSCanvas"></canvas>
                </div>
            </th>
            <th style="vertical-align: top;">
                <h2>Parameters</h2>
                <table cols=1 rows=7>
                    <tr>
                        <th>
                            <button id="apply_changes" onclick="apply_changes()" style="font-size:15px">apply changes</button>
                        </th>
                    </tr>
                    <tr style="vertical-align: center;">
                        <th>
                            <label for="inpc">c</label><br>
                            <div style="text-align:center;position:relative;display:inline-block;">
                                <input type="text"     id="inpc" placeholder="a+b*i" value="-.7-.4*i" size="16" style="font-size:15px">
                            </div>
                        </th>
                    </tr>
                    <tr style="vertical-align: center;">
                        <th>
                            <label for="inpn">max # iterations</label><br>
                            <div style="text-align:center;position:relative;display:inline-block;">
                                <input type="text"     id="inpn" value="100"  size="16" style="font-size:15px">
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th>
                            <label for="inpf">f(z,c)</label><br>
                            <div style="text-align:center;position:relative;display:inline-block;">
                                <textarea id="inpf" rows="3" cols="16" style="font-size:15px">z^2+c</textarea>
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th>
                            <label for="inpme">parameter escape(z,c)</label><br>
                            <div style="text-align:center;position:relative;display:inline-block;">
                                <textarea id="inpme" rows="3" cols="16" style="font-size:15px">abs(z)>2</textarea>
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th>
                            <label for="inpje">dynamical escape(z,c)</label><br>
                            <div style="text-align:center;position:relative;display:inline-block;">
                                <textarea id="inpje" rows="3" cols="16" style="font-size:15px">abs(z)>2</textarea>
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th>
                            <label for="fractal_preset_cell">Presets</label>
                            <table id="fractal_preset_cell">
                                <tr>
                                    <th>
                                        <select id="fractal_presets" style="font-size:15px">
                                            <option value="mandelbrot">Mandelbrot set</option>
                                            <option value="tricorn">tricorn</option>
                                            <option value="exponential map">exponential map</option>
                                            <option value="exp Schwarz">exp Schwarz</option>
                                            <option value="burning ship">burning ship</option>
                                        </select>
                                    </th>
                                    <th>
                                        <button id="apply_preset" onclick="apply_preset()" style="font-size:15px">apply</button>
                                    </th>
                                </tr>
                            </table>
                        </th>
                    </tr>
                </table>
            </th>
        </tr>
    </table>
    </body>
    <h4>Instructions</h4>
    <ul>
        <li>The left plot is the parameter space and the right is the dynamical plane.</li>
        <li>The white point in the parameter space plot corresponds to the value of "c" to be used for the dynamical plot, and may be dragged.</li>
        <li>The white point in the dynamical plane is the starting point for a plot of the first 8 iterates, and can also be dragged.</li>
        <li>The arrow keys shift and the +/- keys zoom the plot window.</li>
        <li>The text boxes below the plots may be used to edit the function to be iterated, as well as the escape condition. (there are separate escape condition boxes for the dynamical plane and the parameter space to ameliorate problems of numerical stability in certain examples)</li>
    </ul>
    <br><br><br>
</html>
